(function(e,y){typeof exports=="object"&&typeof module<"u"?module.exports=y(require("vue")):typeof define=="function"&&define.amd?define(["vue"],y):(e=typeof globalThis<"u"?globalThis:e||self,e.SilentBox=y(e.Vue))})(this,function(e){"use strict";const y=n=>{const t=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/.exec(n);return t!=null&&t[7]!==void 0?t[7]:""},E=n=>{const t=/(vimeo(pro)?\.com)\/(?:[^\d]+)?(\d+)\??(.*)?$/.exec(n);return t?t[3]:""},$=n=>{const t=/(?:player\.twitch\.tv\/\?channel=|twitch\.tv\/)([a-zA-Z0-9_]+)/.exec(n);return t?t[1]:""},N=n=>{if(L(n))try{const r=new XMLHttpRequest;return r.open("GET",n,!1),r.send(null),JSON.parse(r.responseText)}catch(r){return console.log(r),null}throw new Error("Given string: url is not valid URL address.")},C=n=>["youtube.com","youtu.be","youtube-nocookie.com","vimeo.com","twitch.tv"].some(t=>n.includes(t)),R=n=>[".mp4",".ogg",".webm",".mov",".flv",".wmv",".mkv"].some(t=>n.toLowerCase().includes(t)),U=(n,r="")=>{var t;if(/(youtu\.?be)/.test(n)){const s=y(n);return`${location.protocol}//img.youtube.com/vi/${s}/hqdefault.jpg`}else if(/(vimeo(pro)?\.com)/.test(n)){const s=E(n),c=N(`${location.protocol}//vimeo.com/api/v2/video/${s}.json`);return c&&c.length>0?(t=c[0])==null?void 0:t.thumbnail_medium:r}else{if(L(n))return n;throw new Error("Given string: src is not valid URL address.")}},L=n=>new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(n),T=e.createElementVNode("div",{id:"silentbox-overlay__background"},null,-1),M=["onClick"],G={id:"silentbox-overlay__embed"},z=["allow","src"],K={key:1,class:"silentbox-video__frame"},P=["src","autoplay","controls"],D=["srcset","src","alt"],O={key:1,id:"silentbox-overlay__tool-buttons"},Y=["href"],X=["onClick","onKeyup"],j=[e.createElementVNode("div",{class:"icon"},null,-1)],A={key:0,id:"silentbox-overlay__arrow-buttons"},H=["onClick","onKeyup"],q=["onClick","onKeyup"],V=e.defineComponent({__name:"SilentBoxOverlay",props:{item:null,visible:{type:Boolean},currentItem:null,totalItems:null},emits:["silentbox-internal-close-overlay","silentbox-internal-get-next-item","silentbox-internal-get-prev-item","silentbox-overlay-opened","silentbox-overlay-hidden"],setup(n,{emit:r}){const t=n,s=e.inject("silent-box-options")||{downloadButtonLabel:"Download"},c=e.computed(()=>typeof t.item.download=="string"?t.item.download:t.item.src),l=i=>{let a="";if(y(i)){const m=new URL(i),p=m.searchParams;t.item.autoplay&&p.set("autoplay","1"),t.item.controls||p.set("controls","0"),m.search=p.toString(),a=m.toString()}return a},I=i=>{let a="";if(E(i)){const m=new URL(i),p=m.searchParams;t.item.autoplay&&p.set("autoplay","1"),m.search=p.toString(),a=m.toString()}return a},w=i=>{let a="";const u=$(i);return u&&(a=`${location.protocol}//player.twitch.tv/?channel=${u}&parent=${location.hostname}`,t.item.autoplay&&(a+="&autoplay=true")),a},g=i=>/(youtu\.?be)/.test(i)?l(i):/(vimeo(pro)?\.com)/.test(i)?I(i):/(?:player\.|clips\.|www\.)?twitch\.tv/.test(i)?w(i):i,B=()=>{document.body.classList.contains("silentbox-is-opened")||document.body.classList.add("silentbox-is-opened")},h=()=>{document.body.classList.contains("silentbox-is-opened")&&document.body.classList.remove("silentbox-is-opened")},b=e.reactive({name:"silentbox-animation__swipe-left"}),x=()=>{r("silentbox-internal-close-overlay")},f=()=>{b.name="silentbox-animation__swipe-left",r("silentbox-internal-get-next-item")},_=()=>{b.name="silentbox-animation__swipe-right",r("silentbox-internal-get-prev-item")},o=e.reactive({posX:0,posY:0}),v=i=>{const{clientX:a,clientY:u}=i.touches[0];o.posX=a,o.posY=u},d=i=>{const{clientX:a,clientY:u}=i.touches[0],{posX:m,posY:p}=o;if(m===0||p===0)return;const S=m-a,Z=p-u;Math.abs(S)>Math.abs(Z)&&(S>0?f():_()),o.posX=0,o.posY=0},k=i=>{i.code==="Escape"&&x(),i.code==="ArrowRight"&&f(),i.code==="ArrowLeft"&&_()};return e.onUpdated(()=>{t.visible?(window.addEventListener("keyup",k),B()):(window.removeEventListener("keyup",k),h())}),(i,a)=>t.visible?(e.openBlock(),e.createElementBlock("div",{key:0,id:"silentbox-overlay",role:"overlay",onTouchstart:v,onTouchmove:d},[T,e.createVNode(e.Transition,{name:b.name,mode:"out-in"},{default:e.withCtx(()=>[(e.openBlock(),e.createElementBlock("div",{id:"silentbox-overlay__content",onClick:e.withModifiers(x,["stop"]),key:t.item.src},[e.createElementVNode("div",G,[e.createElementVNode("div",{id:"silentbox-overlay__container",onClick:a[0]||(a[0]=e.withModifiers(()=>{},["stop"]))},[e.unref(C)(t.item.src)?(e.openBlock(),e.createElementBlock("iframe",{key:0,allow:`accelerometer; ${!!t.item.autoplay&&"autoplay;"} encrypted-media; gyroscope; picture-in-picture`,src:g(t.item.src),frameborder:"0",width:"100%",height:"100%",allowfullscreen:""},null,8,z)):e.unref(R)(t.item.src)?(e.openBlock(),e.createElementBlock("div",K,[e.createElementVNode("video",{src:t.item.src,autoplay:!!t.item.autoplay,controls:t.item.controls,class:"silentbox-video__embed"},null,8,P)])):(e.openBlock(),e.createElementBlock("img",{key:2,srcset:t.item.srcSet?t.item.srcSet.join(","):t.item.src,src:t.item.src,alt:t.item.alt},null,8,D))]),t.item.description?(e.openBlock(),e.createElementBlock("p",{key:0,id:"silentbox-overlay__description",onClick:a[1]||(a[1]=e.withModifiers(()=>{},["prevent","stop"]))},e.toDisplayString(t.item.description),1)):e.createCommentVNode("",!0),t.item.download?(e.openBlock(),e.createElementBlock("div",O,[e.createElementVNode("a",{href:e.unref(c),class:"download",download:""},e.toDisplayString(e.unref(s).downloadButtonLabel),9,Y)])):e.createCommentVNode("",!0)])],8,M))]),_:1},8,["name"]),e.createElementVNode("button",{id:"silentbox-overlay__close-button",role:"button",tabindex:"3",onClick:e.withModifiers(x,["prevent"]),onKeyup:e.withKeys(x,["enter"])},j,40,X),t.totalItems>1?(e.openBlock(),e.createElementBlock("div",A,[e.createElementVNode("button",{class:"arrow arrow-previous",role:"button",tabindex:"2",onClick:e.withModifiers(_,["stop"]),onKeyup:e.withKeys(_,["enter"])},null,40,H),e.createElementVNode("button",{class:"arrow arrow-next",role:"button",tabindex:"1",onClick:e.withModifiers(f,["stop"]),onKeyup:e.withKeys(f,["enter"])},null,40,q)])):e.createCommentVNode("",!0)],32)):e.createCommentVNode("",!0)}}),ee="",F=["href","onClick"],W=["loading","src","alt","width","height"],J=e.defineComponent({__name:"SilentBoxGallery",props:{lazyLoading:{type:Boolean},previewCount:null,fallbackThumbnail:null,gallery:null,image:null},emits:["silentbox-overlay-opened","silentbox-overlay-hidden","silentbox-overlay-next-item-displayed","silentbox-overlay-prev-item-displayed"],setup(n,{expose:r,emit:t}){const s=n,c=e.computed(()=>s.gallery?s.gallery.length:1),l=e.reactive({item:{src:"",alt:"",thumbnailWidth:150,thumbnailHeight:0,thumbnail:"",autoplay:!1,controls:!0,description:"",download:!1},visible:!1,currentItem:0,totalItems:c}),I=o=>C(o)?U(o,s.fallbackThumbnail):o,w=o=>({...l.item,download:!1,...o,thumbnail:o.thumbnail?o.thumbnail:I(o.src)}),g=()=>s.gallery&&s.gallery.length>0?s.gallery.map(w):s.image?[w(s.image)]:[],B=e.computed(()=>s.previewCount&&s.previewCount>0&&s.gallery?s.gallery.slice(0,s.previewCount).map(w):g()),h=e.computed(()=>g()),b=(o,v=0)=>{l.visible=!0,l.item=o,l.currentItem=v,t("silentbox-overlay-opened",o)},x=()=>{l.visible=!1,t("silentbox-overlay-hidden",l.item)},f=()=>{let o=l.currentItem+1;o=o<=h.value.length-1?o:0,l.item=h.value[o],l.currentItem=o,t("silentbox-overlay-next-item-displayed",l.item)},_=()=>{let o=l.currentItem-1;o=o>=0?o:h.value.length-1,l.item=h.value[o],l.currentItem=o,t("silentbox-overlay-prev-item-displayed",l.item)};return r({openOverlay:b}),(o,v)=>(e.openBlock(),e.createElementBlock("div",null,[e.renderSlot(o.$slots,"default"),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(B),(d,k)=>(e.openBlock(),e.createElementBlock("a",{key:d.src,href:d.src,onClick:e.withModifiers(i=>b(d,k),["prevent"]),class:"silentbox-item"},[e.renderSlot(o.$slots,"silentbox-item",{silentboxItem:d},()=>[e.createElementVNode("img",{loading:n.lazyLoading?"lazy":"eager",src:d.thumbnail,alt:d.alt,width:d.thumbnailWidth,height:d.thumbnailHeight},null,8,W)])],8,F))),128)),e.createVNode(V,{visible:l.visible,item:l.item,"current-item":l.currentItem,"total-items":e.unref(c),onSilentboxInternalCloseOverlay:x,onSilentboxInternalGetNextItem:f,onSilentboxInternalGetPrevItem:_},null,8,["visible","item","current-item","total-items"])]))}}),te="";return{install:(n,r={})=>{n.component("silent-box",J),n.provide("silent-box-options",{downloadButtonLabel:"Download",...r}),n.config.globalProperties.$silentbox={open:t=>{const s=document.createElement("div");s.setAttribute("id","silentbox--false-root");const c=e.createApp(V,{item:t,currentItem:1,totalItems:1,visible:!0,onSilentboxInternalCloseOverlay:()=>{l.$emit("silentbox-overlay-hidden",t),c.unmount(),s.remove()}}),l=c.mount(s);l.$emit("silentbox-overlay-opened",t),l.$forceUpdate(),document.body.appendChild(l.$el)}}}}});
